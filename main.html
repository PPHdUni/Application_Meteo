<!DOCTYPE html>
<html lang="fr"> 
<head>
	<title>Application_Meteo</title>
	<meta charset="UTF-8">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	<script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
	<h2 class="text-center">Current weather</h2>
	<div class="jumbotron container" id="root" style="padding-bottom: 30%">
		<h1 class="text-center">Welcome</h1>
	</div>
	<script type="text/babel">
	
	/*class MeteoApp extends React.Component {
	
		constructor(props) {
			super(props);
			this.state = {location: 0, welcome: true};
			this.handleSubmit = this.handleSubmit.bind(this);
		}
		
		handleSubmit(event) {
			event.preventDefault();
			this.setState({location: event.target.location, welcome: false});
		}
		
		render() {
		
		
		}
	
	} */
	
	var welcome = true

	function MeteoFunction() {
	
		var location = ""
		var returnValue
		
		const key = "***REMOVED***"
	  
		const { useEffect } = React
		const { useState } = React
		
		const [results,updateResults]=useState([]);
		
		const fetchMeteo = (event) => {
		
			location = event.target.location.value
			event.preventDefault();
			welcome = false
		
			fetch('https://api.weatherapi.com/v1/current.json?key='+key+'&q='+location)
				.then(response => response.json())
				.then(function(myJson) {
					updateResults(myJson);
					console.log(location);
				});
		}
								
		if(welcome) {
			returnValue = ( 
			<><div id="form"> <form class="text-center" onSubmit={fetchMeteo}>
				 <label>
				 Location :
				 <input type="text" name="location" defaultValue={location} size="50"/>
				 </label>
				 <input type="submit" value="Submit" />
			</form></div>
			<div id="meteoInfo">
			<h1 class="text-center">Welcome</h1></div></>
			);}
		else {
			returnValue = ( 
			<><div id="form"> <form class="text-center" onSubmit={fetchMeteo}>
				 <label>
				 Location :
				 <input type="text" name="location" defaultValue={location} size="50"/>
				 </label>
				 <input type="submit" value="Submit" />
			</form></div>
			<div id="meteoInfo"><h2 class="text-center">{results.location.name}, {results.location.country}</h2>
			
			<p class="text-center">Last update: {results.current.last_updated}</p>
			
			<h1 class="text-center">Temperature: {results.current.temp_c} Â°C</h1>
			
			<h1 class="text-center">Condition: {results.current.condition.text}</h1>
			
			<h2 class="text-center">Wind speed: {results.current.wind_kph} kilometers per hour</h2>
			
			<h2 class="text-center">Humidity: {results.current.humidity}%</h2></div></>
			);
		}
		
		return returnValue
	}

	const root = ReactDOM.createRoot(document.getElementById('root'));
	root.render(<MeteoFunction />);
	</script>
</body>
</html>
<style>
    body {background-color: lightgrey;
			font-family: Georgia, serif}
	.jumbotron {background-color: white;}
	#meteoInfo {padding-top: 10%}
	#form {padding-top: 1%}
</style>